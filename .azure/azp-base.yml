# Docker
# Build a Docker image 
# https://docs.microsoft.com/azure/devops/pipelines/languages/docker

trigger:
  branches:
    include:
    - 'master'
  paths:
    include:
    - '.azure/azp-base.xml'
  tags:
    include:
    - 'temp-*'
    - 'test-*'

resources:
- repo: self

variables:
  baseDockerfileDir: './dockeragent/ubuntu/18.04'
  imageName: azpagent-base
  tag: '$(Build.BuildId)'

stages:
- template: 'azp-templates/build-image.yaml'
  parameters:
    dockerFile: '$(baseDockerfileDir)/Dockerfile'
    imageName: '$(imageName)'
